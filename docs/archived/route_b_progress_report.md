# Route B å®æ–½è¿›åº¦æŠ¥å‘Š

**æ›´æ–°æ—¶é—´**: 2026-02-12
**å½“å‰é˜¶æ®µ**: Phase 0 - ç­‰å¾…ç”¨æˆ·æ‰§è¡Œ
**æ€»ä½“è¿›åº¦**: 30% ï¼ˆä»£ç å·²å°±ç»ªï¼Œç­‰å¾…éªŒè¯ï¼‰

---

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### Phase 0: å»é£é™©å®éªŒ PoCï¼ˆä»£ç å®Œæˆï¼Œç­‰å¾…æ‰§è¡Œï¼‰

#### C++ Hook ä»£ç 
- âœ… `hook/src/sns_moments_poc.h` - PoC å¤´æ–‡ä»¶
- âœ… `hook/src/sns_moments_poc.cpp` - Hook å›è°ƒå®ç°
  - Hook `OnSnsTimeLineSceneFinish` å›è°ƒ
  - è®°å½•æ—¶é—´æˆ³å’Œå†…å®¹åˆ° log
  - SEH å¼‚å¸¸å¤„ç†é˜²æ­¢å´©æºƒ
- âœ… `hook/CMakeLists.txt` - å·²æ·»åŠ æ–°æºæ–‡ä»¶
- âœ… `hook/src/dllmain.cpp` - å·²é›†æˆ PoC åˆå§‹åŒ–

#### Python æµ‹è¯•è„šæœ¬
- âœ… `examples/phase0_timing_test.py` - æ—¶é—´å¯¹æ¯”æµ‹è¯•
  - è½®è¯¢ UIï¼Œæ£€æµ‹å¸–å­å¯è§æ—¶é—´
  - è§£æ DLL logï¼Œæå– Hook å›è°ƒæ—¶é—´æˆ³
  - è‡ªåŠ¨è®¡ç®—æ—¶é—´å·®å¹¶ç»™å‡ºåˆ¤æ–­

#### è¾…åŠ©å·¥å…·
- âœ… `scripts/phase0_auto_test.py` - è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬
  - ä¸€é”®ç¼–è¯‘ã€æ³¨å…¥ã€éªŒè¯
  - è‡ªåŠ¨æ£€æµ‹å¾®ä¿¡ PID
  - è¯¦ç»†é”™è¯¯æç¤º
- âœ… `scripts/extract_signature.py` - ç­¾åæå–å·¥å…·
  - è§£æ IDA Pro å¯¼å‡ºçš„æ±‡ç¼–
  - è‡ªåŠ¨å»ºè®®é€šé…ç¬¦ä½ç½®

#### æ–‡æ¡£
- âœ… `docs/phase0_execution_guide.md` - è¯¦ç»†æ‰§è¡ŒæŒ‡å—
- âœ… `docs/route_b_checklist.md` - å®æ–½è¿›åº¦ checklist
- âœ… `docs/route_b_phase0_ready.md` - å¿«é€Ÿå¼€å§‹æŒ‡å—
- âœ… `docs/route_b_progress_report.md` - æœ¬æŠ¥å‘Š

#### ä»»åŠ¡è·Ÿè¸ª
- âœ… åˆ›å»º 7 ä¸ªä»»åŠ¡ï¼ˆè¦†ç›– Phase 0-4ï¼‰
- âœ… è®¾ç½®ä»»åŠ¡ä¾èµ–å…³ç³»

### Phase 1: æ¡†æ¶ä»£ç å·²å‡†å¤‡ï¼ˆå¾… Phase 0 éªŒè¯åä½¿ç”¨ï¼‰

- âœ… `hook/src/sns_moments.h` - å…¬å¼€æ¥å£
- âœ… `hook/src/sns_moments.cpp` - å®Œæ•´å®ç°ï¼ˆ~300 è¡Œï¼‰
  - å†…å­˜å¿«ç…§ç¼“å­˜
  - å»é‡é€»è¾‘
  - æ€§èƒ½ç»Ÿè®¡

---

## ğŸš§ å½“å‰é˜»å¡ç‚¹

### âš ï¸ å…³é”®ï¼šéœ€è¦æå–å‡½æ•°ç­¾åï¼ˆTask #1ï¼‰

**è¿™æ˜¯ Phase 0 å”¯ä¸€çš„é˜»å¡æ­¥éª¤ï¼**

å½“å‰ä»£ç ä¸­çš„ç­¾åæ˜¯å ä½ç¬¦ï¼š
```cpp
// hook/src/sns_moments_poc.cpp, line 155
const char* signature = "48 89 5C 24 ?? 57 48 83 EC 30";  // éœ€è¦æ›¿æ¢ï¼
```

**å¿…é¡»æ­¥éª¤**:
1. ä½¿ç”¨ IDA Pro æ‰“å¼€ `C:\Program Files\Tencent\Weixin\Weixin.dll`
2. æœç´¢å­—ç¬¦ä¸²é”šç‚¹ï¼š`SnsTimeLineScene`, `OnSnsFinish`, `TimelineObject`
3. å®šä½ `OnSnsTimeLineSceneFinish` å‡½æ•°
4. æå– 16-24 å­—èŠ‚ç­¾å
5. æ›´æ–° `hook/src/sns_moments_poc.cpp` line 155

**è¾…åŠ©å·¥å…·**:
```bash
# 1. åœ¨ IDA Pro ä¸­å¤åˆ¶æ±‡ç¼–ä»£ç åˆ° ida_export.txt
# 2. è¿è¡Œè¾…åŠ©å·¥å…·
python scripts/extract_signature.py ida_export.txt

# 3. å·¥å…·ä¼šè¾“å‡ºå»ºè®®çš„ç­¾åï¼Œå¤åˆ¶åˆ°ä»£ç ä¸­
```

**æ—¶é—´é¢„ç®—**: 30-60 åˆ†é’Ÿï¼ˆå¦‚æœç†Ÿæ‚‰ IDA Proï¼‰

---

## ğŸ“‹ ä¸‹ä¸€æ­¥è¡ŒåŠ¨ï¼ˆæŒ‰é¡ºåºï¼‰

### 1. æå–å‡½æ•°ç­¾åï¼ˆç«‹å³æ‰§è¡Œï¼‰

**è´£ä»»äºº**: ç”¨æˆ·
**æ—¶é—´**: 30-60 åˆ†é’Ÿ
**æ–‡æ¡£**: `docs/phase0_execution_guide.md`

### 2. ç¼–è¯‘å¹¶æ³¨å…¥ DLLï¼ˆTask #2ï¼‰

```bash
python scripts/phase0_auto_test.py --all
```

**é¢„æœŸè¾“å‡º**:
```
[OK] DLL built: hook/build/bin/Release/pywechat_hook.dll
[OK] Found main process: PID=12345, Memory=234.5MB
[OK] DLL injected
âœ… Phase 0 å‡†å¤‡å®Œæˆï¼
```

### 3. è¿è¡Œæ€§èƒ½æµ‹è¯•ï¼ˆTask #3ï¼‰

```bash
python examples/phase0_timing_test.py
```

**æ‰‹åŠ¨æ“ä½œ**: åœ¨æç¤ºæ—¶æ‰‹åŠ¨åˆ·æ–°æœ‹å‹åœˆ 5 æ¬¡

**åˆ¤æ–­æ ‡å‡†**:
- âœ… **å¹³å‡æå‰ â‰¥2s** â†’ ç»§ç»­ Phase 1-4
- âš ï¸ **å¹³å‡æå‰ 1-2s** â†’ è¯„ä¼° ROI
- âŒ **å¹³å‡æå‰ <1s** â†’ æ”¾å¼ƒ Route B

### 4. å†³ç­–ç‚¹ï¼ˆ2-4 å°æ—¶åï¼‰

**å¦‚æœ Phase 0 æˆåŠŸ**:
- ç»§ç»­å®æ–½ Phase 1-4
- é¢„è®¡ 2-3 å¤©å®Œæˆå…¨éƒ¨

**å¦‚æœ Phase 0 å¤±è´¥**:
- åœæ­¢ Route B
- è€ƒè™‘å¤‡é€‰æ–¹æ¡ˆï¼ˆHook UI æ¸²æŸ“ã€ç›‘å¬æ¶ˆæ¯é˜Ÿåˆ—ï¼‰

---

## ğŸ“Š ä»»åŠ¡çŠ¶æ€

### å½“å‰å¯æ‰§è¡Œä»»åŠ¡
- â¸ï¸ **Task #1**: æå–å‡½æ•°ç­¾åï¼ˆé˜»å¡æ‰€æœ‰åç»­ä»»åŠ¡ï¼‰

### è¢«é˜»å¡çš„ä»»åŠ¡
- â¸ï¸ Task #2: ç¼–è¯‘å¹¶æ³¨å…¥ DLL (blocked by #1)
- â¸ï¸ Task #3: è¿è¡Œæ€§èƒ½æµ‹è¯• (blocked by #2)
- â¸ï¸ Task #4: Phase 1 å®ç° (blocked by #3)
- â¸ï¸ Task #5: Phase 2 Pipe é›†æˆ (blocked by #4)
- â¸ï¸ Task #6: Phase 3 Python ç›‘æ§å™¨ (blocked by #5)
- â¸ï¸ Task #7: Phase 4 æ€§èƒ½éªŒè¯ (blocked by #6)

æŸ¥çœ‹ä»»åŠ¡è¯¦æƒ…ï¼š
```bash
# åœ¨ Claude Code CLI ä¸­
/tasks
```

---

## ğŸ¯ é¢„æœŸæ”¶ç›Š

### å¦‚æœ Phase 0 æˆåŠŸï¼ˆå¹³å‡æå‰ 2.5sï¼‰

**å½“å‰æ€§èƒ½**:
```
T=0s    é¢˜ç›®å‘å¸ƒ
T=+2.5s UI åˆ·æ–°æ˜¾ç¤º â† ç“¶é¢ˆ
T=+3s   OCR è¯†åˆ«
T=+5s   AI ç”Ÿæˆç­”æ¡ˆ
T=+13s  è¯„è®ºå‘é€å®Œæˆ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æ€»è®¡ï¼š13 ç§’ï¼Œæ’å 20+ å
```

**Route B åæ€§èƒ½**:
```
T=0s    é¢˜ç›®å‘å¸ƒ
T=<1s   Hook å›è°ƒæ•è· â† æå‰ 2.5sï¼
T=+1s   ç›´æ¥æå–æ–‡æœ¬
T=+3s   AI ç”Ÿæˆç­”æ¡ˆ
T=+11s  è¯„è®ºå‘é€å®Œæˆ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æ€»è®¡ï¼š10 ç§’ï¼Œæ’å ~15 åï¼ˆæé€Ÿ 23%ï¼‰
```

### é•¿æœŸæ„¿æ™¯ï¼ˆRoute B + Route A å¹¶å‘ï¼‰

```
T=0s    é¢˜ç›®å‘å¸ƒ
T=<1s   Hook å›è°ƒæ•è·
T=+1s   ç›´æ¥æå–æ–‡æœ¬
T=+3s   AI ç”Ÿæˆç­”æ¡ˆ
T=+3s   å¹¶å‘å‘é€å®Œæˆ â† ç»“åˆ Route A
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æ€»è®¡ï¼š3 ç§’ï¼Œæ’åå‰ 3 åï¼ˆæé€Ÿ 77%ï¼‰
```

---

## ğŸ“ å¿«é€Ÿå‚è€ƒ

### å¸¸ç”¨å‘½ä»¤

```bash
# 1. è‡ªåŠ¨åŒ–æµ‹è¯•ï¼ˆå…¨æµç¨‹ï¼‰
python scripts/phase0_auto_test.py --all

# 2. åªç¼–è¯‘
python scripts/phase0_auto_test.py --build

# 3. åªæ³¨å…¥ï¼ˆè·³è¿‡ç¼–è¯‘ï¼‰
python scripts/phase0_auto_test.py --inject

# 4. è¿è¡Œæ€§èƒ½æµ‹è¯•
python examples/phase0_timing_test.py

# 5. æŸ¥çœ‹ DLL log
tail -f pywechat_hook.log

# 6. æŸ¥çœ‹ä»»åŠ¡åˆ—è¡¨
/tasks  # åœ¨ Claude Code CLI ä¸­
```

### é‡è¦æ–‡ä»¶è·¯å¾„

```
hook/src/sns_moments_poc.cpp         # Phase 0 PoCï¼ˆéœ€è¦æ›´æ–°ç­¾å line 155ï¼‰
hook/build/bin/Release/pywechat_hook.dll  # ç¼–è¯‘åçš„ DLL
pywechat_hook.log                    # Hook DLL æ—¥å¿—
examples/phase0_timing_test.py       # æ€§èƒ½æµ‹è¯•è„šæœ¬
scripts/phase0_auto_test.py          # è‡ªåŠ¨åŒ–å·¥å…·
scripts/extract_signature.py         # ç­¾åæå–å·¥å…·
docs/phase0_execution_guide.md       # è¯¦ç»†æ‰§è¡ŒæŒ‡å—
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: æˆ‘ä¸ç†Ÿæ‚‰ IDA Proï¼Œæ€ä¹ˆåŠï¼Ÿ

**A**: æŒ‰ç…§ `docs/phase0_execution_guide.md` çš„è¯¦ç»†æ­¥éª¤æ“ä½œï¼š
1. å®‰è£… IDA Pro Freeï¼ˆæˆ–è¯•ç”¨ç‰ˆï¼‰
2. æ‰“å¼€ Weixin.dll
3. æŒ‰ Shift+F12 æœç´¢å­—ç¬¦ä¸²
4. æŒ‰æ•™ç¨‹æ“ä½œå³å¯

**é¢„è®¡å­¦ä¹ æ—¶é—´**: 30 åˆ†é’Ÿ

### Q2: æ‰¾ä¸åˆ°å‡½æ•°ç­¾åæ€ä¹ˆåŠï¼Ÿ

**A**: å¤‡é€‰æ–¹æ¡ˆï¼š
1. ä½¿ç”¨ Frida åŠ¨æ€æ¢æµ‹ï¼ˆè§æ‰§è¡ŒæŒ‡å—ï¼‰
2. é™çº§åˆ° WeChat 3.9.5.81ï¼ˆä½¿ç”¨ wxhelper éªŒè¯è¿‡çš„ç­¾åï¼‰
3. æ”¾å¼ƒ Route Bï¼Œè€ƒè™‘å…¶ä»–æ–¹æ¡ˆ

### Q3: Hook å®‰è£…æˆåŠŸï¼Œä½†æ²¡æœ‰å›è°ƒæ—¥å¿—ï¼Ÿ

**A**: å¯èƒ½åŸå› ï¼š
1. å‡½æ•°åœ°å€å®šä½é”™è¯¯ï¼ˆç­¾åä¸å¯¹ï¼‰
2. åç§»ä¸æ­£ç¡®ï¼ˆéœ€è¦è°ƒæ•´ +0x30, +0x38 ç­‰ï¼‰
3. éœ€è¦ç‰¹å®šæ“ä½œæ‰èƒ½è§¦å‘

**æ’æŸ¥æ–¹æ³•**: è§ `docs/phase0_execution_guide.md` Q3

---

## ğŸ“– ç›¸å…³æ–‡æ¡£

- **å¿…è¯»**: `docs/phase0_execution_guide.md` - è¯¦ç»†æ‰§è¡ŒæŒ‡å—
- **å¿«é€Ÿå¼€å§‹**: `docs/route_b_phase0_ready.md`
- **è¿›åº¦è·Ÿè¸ª**: `docs/route_b_checklist.md`
- **å®Œæ•´æ–¹æ¡ˆ**: `docs/route_b_background_moments_fetch.md`

---

## ğŸ”” å½“å‰çŠ¶æ€æ€»ç»“

- âœ… Phase 0 ä»£ç å·²å®Œæˆ
- âœ… è¾…åŠ©å·¥å…·å·²å°±ç»ª
- âœ… Phase 1 æ¡†æ¶å·²å‡†å¤‡
- âš ï¸ **ç­‰å¾…ç”¨æˆ·æå–å‡½æ•°ç­¾å** â† å”¯ä¸€é˜»å¡ç‚¹
- â±ï¸ é¢„è®¡ 2-4 å°æ—¶å®Œæˆ Phase 0 éªŒè¯

**ä¸‹ä¸€æ­¥**: é˜…è¯» `docs/phase0_execution_guide.md`ï¼Œå¼€å§‹æå–å‡½æ•°ç­¾åã€‚

---

**ç»´æŠ¤è€…**: Claude Sonnet 4.5
**Git æäº¤**:
- `e955e41` - Phase 0 PoC ä»£ç 
- `6e1e316` - è¾…åŠ©å·¥å…·å’Œ Phase 1 æ¡†æ¶
